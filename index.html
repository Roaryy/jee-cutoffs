<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JEE Cutoffs</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
</head>
<body>
    <div class="container">
        <header class="d-flex justify-content-between align-items-center">
            <h1>JEE Cutoffs</h1>
        </header>

        <!-- Filter-Based Search Section -->
        <div class="filter-section">
            <h3>Filter-Based Search</h3>
            <div class="row g-2">
                <div class="col-md-4 col-sm-6">
                    <select id="year" class="form-select" onchange="predictColleges()">
                        <option value="all">All Years</option>
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024" selected>2024</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select id="institute" class="form-select" onchange="updateSpecificInstituteDropdown(); populateProgramDropdown()">
                        <option value="iit">IIT</option>
                        <option value="nit">NIT</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6" id="specific-institute-container" style="display: none;">
                    <select id="specific-institute" class="form-select" onchange="populateProgramDropdown(); predictColleges()">
                        <option value="all">All</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6 quota-container" id="quota-container">
                    <select id="state_quota" class="form-select" onchange="predictColleges()">
                        <option value="all">All Quotas</option>
                        <option value="OS">OS</option>
                        <option value="HS">HS</option>
                    </select>
                    <select id="hs_os_quota" class="form-select" onchange="predictColleges()" style="display: none;">
                        <option value="both">Both</option>
                        <option value="HS">Home State (HS)</option>
                        <option value="OS">Other State (OS)</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select id="program" class="form-select" onchange="predictColleges()">
                        <option value="all">All Branches</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select id="duration" class="form-select" onchange="predictColleges()">
                        <option value="all">All Durations</option>
                        <option value="4">4 Years</option>
                        <option value="5">5 Years</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select id="program-type" class="form-select" onchange="predictColleges()">
                        <option value="all">All Program Types</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select id="pool" class="form-select" onchange="predictColleges()">
                        <option value="all">All Genders</option>
                        <option value="Gender-Neutral">Gender-Neutral</option>
                        <option value="Female-only">Female-only</option>
                    </select>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select id="filter-category" class="form-select" onchange="syncCategories(this); predictColleges()">
                        <option value="all">All Categories</option>
                        <option value="OPEN">OPEN</option>
                        <option value="EWS">EWS</option>
                        <option value="OBC-NCL">OBC-NCL</option>
                        <option value="SC">SC</option>
                        <option value="ST">ST</option>
                        <option value="OPEN (PwD)">OPEN (PwD)</option>
                        <option value="EWS (PwD)">EWS (PwD)</option>
                        <option value="OBC-NCL (PwD)">OBC-NCL (PwD)</option>
                        <option value="SC (PwD)">SC (PwD)</option>
                        <option value="ST (PwD)">ST (PwD)</option>
                    </select>
                </div>
            </div>
            <div class="button-group">
                <button class="btn btn-secondary rounded-pill" onclick="resetFilters()">Reset</button>
            </div>
        </div>

        <!-- Rank-Based Search Section -->
        <div class="rank-section mt-4">
            <h3>Rank-Based Search</h3>
            <div class="row g-2">
                <div class="col-md-4 col-sm-6">
                    <input type="text" id="jee-rank" class="form-control" placeholder="Enter your JEE rank" oninput="predictColleges()">
                    <small id="rank-label" class="form-text">Enter your JEE rank</small>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select id="rank-category" class="form-select" onchange="syncCategories(this); predictColleges()">
                        <option value="all">All Categories</option>
                        <option value="OPEN">OPEN</option>
                        <option value="EWS">EWS</option>
                        <option value="OBC-NCL">OBC-NCL</option>
                        <option value="SC">SC</option>
                        <option value="ST">ST</option>
                        <option value="OPEN (PwD)">OPEN (PwD)</option>
                        <option value="EWS (PwD)">EWS (PwD)</option>
                        <option value="OBC-NCL (PwD)">OBC-NCL (PwD)</option>
                        <option value="SC (PwD)">SC (PwD)</option>
                        <option value="ST (PwD)">ST (PwD)</option>
                    </select>
                </div>
            </div>
        </div>

        <div id="loading" class="text-center mt-3" style="display: none;">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p>Loading data...</p>
        </div>

        <!-- Information Section -->
        <div class="info-section">
            <button class="info-toggle" onclick="toggleInfoSection()">Instructions</button>
            <div class="info-content" id="info-content" style="display: none;">
                <p>This tool helps you predict college admissions based on JEE ranks. Here's how to use it:</p>
                <ul>
                    <li><strong>Data Scope:</strong> This contains the last round data (Round 7 for 2017–2019, Round 6 for 2020–2023, Round 5 for 2024). For all previous years, only the final round Opening/Closing ranks are shown here.</li>
                    <li><strong>Gender Filter Note:</strong> Gender-based reservations were introduced in 2018. For 2017, all seats are listed as Gender-Neutral since this was before the reservation policy. If you select "Female-only" in the gender filter, 2017 data will still show Gender-Neutral seats as they were the only type available that year.</li>
                    <li><strong>Preparatory Ranks:</strong> 'P' means Preparatory. Add a "P" to your rank (e.g., "500P") in the Rank-Based Search to filter for preparatory ranks that you qualify for, or enter just "P" to see all preparatory ranks. Without "P", only non-preparatory ranks are shown. Learn more about Preparatory Courses: 
                        <a href="https://www.collegedekho.com/articles/what-is-preparatory-course-in-iit/" target="_blank">CollegeDekho</a> | 
                        <a href="https://insightiitb.org/demystifying-preparatory-courses-in-iits/" target="_blank">InsightIITB</a>
                    </li>
                    <li><strong>Filters:</strong> Use the "Filter-Based Search" to narrow down by institute, branch, category, etc.</li>
                    <li><strong>Rank Search:</strong> Enter your JEE rank in "Rank-Based Search" to find colleges you qualify for.</li>
                    <li><strong>Global Search:</strong> Use the "Global Search" above the table to search for specific branches, institutes, or categories.</li>
                    <li><strong>Download Results:</strong> Click "Download as CSV" below the table to save your filtered results.</li>
                    <li><strong>Reset:</strong> Click the "Reset" button to clear all filters and start over.</li>
                </ul>
            </div>
        </div>

        <!-- Universal Search -->
        <div class="search-container">
            <div class="search-wrapper">
                <input type="text" id="universal-search" class="form-control" placeholder="Global Search" oninput="predictColleges(); toggleClearButton()">
                <span class="clear-search" onclick="clearSearch()">×</span>
            </div>
        </div>

        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>Serial No.</th>
                        <th>Year</th>
                        <th>Institute</th>
                        <th class="quota-column">Quota</th>
                        <th>Branch</th>
                        <th>Duration</th>
                        <th>Degree</th>
                        <th>Category</th>
                        <th>Gender</th>
                        <th>Opening Rank</th>
                        <th>Closing Rank</th>
                    </tr>
                </thead>
                <tbody id="results-table"></tbody>
            </table>
        </div>
        <div class="pagination">
            <button class="btn btn-outline-primary rounded-pill" id="prev-page" onclick="changePage(-1)" disabled>Previous</button>
            <span>Page <span id="current-page">1</span> of <span id="total-pages">1</span></span>
            <button class="btn btn-outline-primary rounded-pill" id="next-page" onclick="changePage(1)" disabled>Next</button>
            <button class="btn btn-outline-success rounded-pill ms-2" onclick="downloadCSV()">Download as CSV</button>
        </div>
    </div>
    <footer>
        <p>This is an open source project! Best of luck to future aspirants, and congratulations to the qualifying students! 🎉</p>
    </footer>
    <script src="script.js"></script>
</body>
</html>
